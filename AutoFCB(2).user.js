var _DontOpen=GM_getResourceText("_DontOpen").replace(/'|"|\[|\]|\s/gi,"").split(",").filter((e=>e)),shortlinks_name=GM_getResourceText("shortlinks_name").replace(/'|"|\[|\]|\s/gi,"").split(",").filter((e=>e)),_open_link_fast=[].map((e=>e.toLowerCase())),_alreadyRun=GM_getValue("_alreadyRun"),_available_link=parseInt(document.getElementsByClassName("amount")[1].textContent),_views_ToVisit=Array.from(document.querySelectorAll("span#views")),_num_ofLink_toVisit=[],_sort_and_Re_Dup=[],_ordered_LinkToVisitOnPage=[],_order_ByName=[],button=document.createElement("button"),body=document.getElementsByClassName("col item")[1].getElementsByClassName("content-box")[0],gist_id="8f5a3bd519f0ebf94708ad624ffd76d2";let hideVisitedShortlinks=document.querySelector("div.shide").querySelector(".cwrapper");/checked/gi.test(hideVisitedShortlinks.innerHTML)||setTimeout((()=>{hideVisitedShortlinks.click(),hideVisitedShortlinks.dispatchEvent(new Event("change"))}),2e3);try{document.getElementsByClassName("col item")[0].scrollIntoView()}catch(e){document.getElementsByClassName("col item")[1].scrollIntoView()}function AutoUpdateDontOpen(){var e=document.createElement("button");document.getElementsByClassName("col item")[2].getElementsByClassName("content-box")[0].appendChild(e);try{GM_getValue("AutoUpdate",!0)?(e.innerHTML="AutoUpdate_ON",e.style="background-color:Violet;color:white",GM_setValue("AutoUpdate",!0)):(GM_setValue("AutoUpdate",!1),e.innerHTML="AutoUpdate_OFF",e.style="background-color:black;color:white"),e.addEventListener("click",(function(t){GM_getValue("AutoUpdate",!0)?(GM_setValue("AutoUpdate",!1),e.innerHTML="AutoUpdate_OFF",e.style="background-color:black;color:white"):(GM_setValue("AutoUpdate",!0),e.innerHTML="AutoUpdate_ON",e.style="background-color:Violet;color:white")}))}catch(e){}}function checkButton(){1==GM_getValue("_alreadyRun")?(GM_setValue("_alreadyRun",!1),button.innerHTML="Script Run",localStorage.removeItem("close"),location.reload(),localStorage.removeItem("close")):(GM_setValue("_alreadyRun",!0),button.innerHTML="Script Stop",localStorage.removeItem("close"),location.reload())}function static_speed(){let e=document.createElement("button");document.getElementsByClassName("col item")[0].getElementsByClassName("content-box")[0].appendChild(e);try{GM_getValue("static",!0)?(e.innerHTML="Static_ON",e.style="background-color:Violet;color:white",GM_setValue("static",!0)):(GM_setValue("static",!1),e.innerHTML="Static_OFF",e.style="background-color:black;color:white"),e.addEventListener("click",(function(t){GM_getValue("static",!0)?(GM_setValue("static",!1),e.innerHTML="Static_OFF",e.style="background-color:black;color:white"):(GM_setValue("static",!0),e.innerHTML="Static_ON",e.style="background-color:Violet;color:white")}))}catch(e){}}function SpeedCtr(){var e=GM_getValue("speed",.1);"undefined"!=String(e)&&"NaN"!=String(e)&&"null"!=String(GM_getValue(e))||GM_setValue("speed",.1);var t=document.getElementsByClassName("col item")[0].getElementsByClassName("content-box")[0],n=document.createElement("p"),o=document.createElement("button"),a=document.createElement("button");t.appendChild(o),o.innerHTML="speed +",t.appendChild(a),a.innerHTML="speed -",t.appendChild(n),n.innerHTML="DS - "+e+" Seconds",o.addEventListener("click",(function(){e=parseFloat((e+.01).toFixed(2)),GM_setValue("speed",e),n.innerHTML="CS - "+GM_getValue("speed")+" Seconds"})),a.addEventListener("click",(function(){GM_getValue("speed")<.05||(e=parseFloat((e-.01).toFixed(2)),GM_setValue("speed",e)),n.innerHTML="CS - "+GM_getValue("speed")+" Seconds"})),static_speed()}function DelayShort(){var e=document.createElement("button");document.getElementsByClassName("shortlinks")[0].appendChild(e);try{GM_getValue("delayShort")?e.innerHTML="Delay":(GM_setValue("delayShort",!1),e.innerHTML="Dnt_Delay"),e.addEventListener("click",(function(t){GM_getValue("delayShort",!0)?(GM_setValue("delayShort",!1),e.innerHTML="Dnt_Delay"):(GM_setValue("delayShort",!0),e.innerHTML="Delay")}))}catch(e){}}if(AutoUpdateDontOpen(),1!=GM_getValue("_alreadyRun"))if(GM_setValue("_alreadyRun",!0),GM_getValue("AutoUpdate")){function get_Shortlinks_and_DontOpen(e){let t=e.responseText.replace(/'|"|\[|\]|\s/gi,"").split(",").filter((e=>e));shortlinks_name=t.map((e=>e.replace(/'/gi,'"').toLowerCase())),GM_xmlhttpRequest({method:"GET",url:"https://gist.github.com/Harfho/"+gist_id+"/raw/_DontOpen.txt?timestamp="+ +new Date,fetch:!1,nocache:!1,onload:Runcode,onerror:window.location.reload})}GM_xmlhttpRequest({method:"GET",url:"https://gist.github.com/Harfho/"+gist_id+"/raw/shortlinks_name.txt?timestamp="+ +new Date,fetch:!1,nocache:!1,onload:get_Shortlinks_and_DontOpen,onerror:window.location.reload})}else Runcode();else SpeedCtr(),body.appendChild(button),button.innerHTML="Script Not Running -- SHORTLINKS="+_views_ToVisit.length,DelayShort(),button.addEventListener("click",(function(){checkButton()}));function Runcode(e=null){var t,n,o=0;if(localStorage.setItem("close","true"),GM_getValue("AutoUpdate")){let t=e.responseText.replace(/'|"|\[|\]|\s/gi,"").split(",").filter((e=>e));_DontOpen=t.map((e=>e.replace(/'/gi,'"').toLowerCase()))}else _DontOpen=_DontOpen.map((e=>e.replace(/'/gi,'"').toLowerCase())),shortlinks_name=shortlinks_name.map((e=>e.replace(/'/gi,'"').toLowerCase()));if(_views_ToVisit.length>=_DontOpen.length)var a=_views_ToVisit.length-_DontOpen.length;else a=_DontOpen.length>=_views_ToVisit.length?"NO":_views_ToVisit.length;if(/404|400/gi.test(_DontOpen+shortlinks_name))throw window.location.reload(),new Error("!! Stop JS");function l(e){return!!_DontOpen.some((t=>new RegExp("^"+t+"$","ig").test(e)))}function i(e){var t=function(e,t,n,o){e.dispatchEvent(new MouseEvent(t,{bubbles:!0,cancelable:!0,clientX:n,clientY:o,button:0}))},n=e,o=n.getBoundingClientRect(),a=o.left+(o.right-o.left)/2,l=o.top+(o.bottom-o.top)/2;t(n,"mousedown",a,l),t(n,"mouseup",a,l),t(n,"click",a,l)}function s(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1)+e)}function r(){let e=_ordered_LinkToVisitOnPage.length;t=setInterval((()=>{try{let c=_ordered_LinkToVisitOnPage.shuffle().splice(0,1)[0],u=c.parentNode.parentNode.parentNode.querySelector("button"),d=c.parentNode.parentNode.getElementsByClassName("name")[0].innerHTML.trim().replace(/(<|\s).*/,"");if(_available_link<=1e3){c=c.textContent;let _=c.match(/\/\d*/)[0],p=c.replace(_,"");if(l(d))e++;else if(shortlinks_name.includes(d.toLowerCase())){if(o++,GM_getValue("use_static","")&&GM_getValue("static")){var a=new Date;a=a.toLocaleString("en-US",{hour:"numeric",hour12:!0}).replace(/\s+/gi,""),n=/(12|0[0-8]|[1-8])am/gi.test(a)?1e3:/(9|1[0-1])am/gi.test(a)?1e3*s(1,3):(/(12|(0|1[0-9]|[1-9]))pm/gi.test(a),1e3*s(1,5))}else n=o*GM_getValue("speed")*1e3,GM_setValue("use_static",!0);setInterval((()=>{p--,p>=0&&(i(u),clearInterval(t),r())}),n)}else console.log(d.toLowerCase(),"Is not among shortlinks to open"),function(e){_DontOpen.push(e.toLowerCase()),shortlinks_name.push(e);var t=atob("Z2hwXzFVMGhPMTFodTZ6eWxaZ0hMWW5qWFdMTjE1d3V5NjBZN0l6Rw=="),n=window.location.host+" added "+e+" to _DontOpen and shortlinks_name";t="Bearer "+t;const o=new Headers({accept:"application/vnd.github.v3+json",Authorization:t,"Content-Type":"application/json"});var a=JSON.stringify({description:n,files:{"shortlinks_name.txt":{content:JSON.stringify(shortlinks_name)},"_DontOpen.txt":{content:JSON.stringify(_DontOpen)}}});fetch("https://api.github.com/gists/"+gist_id,{method:"PATCH",headers:o,body:a,redirect:"follow"}).then((e=>e.text())).then((e=>console.log(n))).catch((e=>console.log("error",e)))}(d)}else n=o*GM_getValue("speed"),l(u)?e++:i(u);clearInterval(t)}catch(e){}clearInterval(t),0!=e?r():(o=0,button.innerHTML="Done opening-Click to Run Again",clearInterval(t),GM_setValue("use_static",!1),function(){let e=Number(GM_getValue("Re_run",0));e<2?(GM_setValue("_alreadyRun",!1),GM_setValue("Re_run",e+1),localStorage.setItem("close","true"),window.close()):(GM_setValue("Re_run",0),GM_setValue("_alreadyRun",!0),localStorage.removeItem("close"),window.close())}())}),n)}Array.prototype.shuffle=function(){let e,t=this.length;for(;t;)e=Math.random()*t-->>>0,[this[t],this[e]]=[this[e],this[t]];return this},function(){for(let e=0;e<_views_ToVisit.length;e++){let t=_views_ToVisit[e].textContent,n=t.match(/\d*\//)[0],o=t.replace(n,"");_num_ofLink_toVisit.push(parseInt(o))}}(),function(){let e=_num_ofLink_toVisit.map((e=>({count:1,name:e}))).reduce(((e,t)=>(e[t.name]=(e[t.name]||0)+t.count,e)),{}),t=Object.keys(e).sort(((t,n)=>e[t]<e[n]));_sort_and_Re_Dup=t}(),function(){for(let e=0;e<_sort_and_Re_Dup.length;e++)for(let t=0;t<_views_ToVisit.length;t++){_views_ToVisit[t].textContent.includes(_sort_and_Re_Dup[e]);let n=_views_ToVisit[t].parentElement.parentElement.getElementsByClassName("name")[0].innerText,o=n.replace(n.match(/\sFCT*\d*.*/),"");0==_order_ByName.includes(o)&&(_ordered_LinkToVisitOnPage.push(_views_ToVisit[t]),_order_ByName.push(o))}}(),SpeedCtr(),DelayShort(),body.appendChild(button),button.addEventListener("click",(function(){checkButton()})),sessionStorage.getItem("reloading")&&(sessionStorage.removeItem("reloading"),0==_alreadyRun?(button.innerHTML="Script Run(Click to Run Again)",localStorage.setItem("close","true")):button.innerHTML="Script Not Running -- SHORTLINKS="+_views_ToVisit.length),sessionStorage.setItem("reloading","true"),_alreadyRun||(button.innerHTML="Script Run ["+a+"] Links will Open",localStorage.setItem("close","true"),GM_setValue("_alreadyRun",!0),r())}
